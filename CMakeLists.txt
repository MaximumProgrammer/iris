CMAKE_MINIMUM_REQUIRED(VERSION 3.6)

PROJECT(ilis)

OPTION(BUILD_SHARED_LIBS "" OFF)
OPTION(ASSIMP_BUILD_TESTS "" OFF)
OPTION(ASSIMP_BUILD_SAMPLES "" OFF)
OPTION(ASSIMP_BUILD_ASSIMP_TOOLS "" OFF)
OPTION(ASSIMP_BUILD_ASSIMP_VIEW "" OFF)
OPTION(ASSIMP_NO_EXPORT "" ON)
OPTION(ASSIMP_BUILD_ZLIB "" ON)
ADD_DEFINITIONS(-DASSIMP_BUILD_NO_MD5_IMPORTER)
ADD_DEFINITIONS(-DASSIMP_BUILD_NO_ASE_IMPORTER)
ADD_DEFINITIONS(-DASSIMP_BUILD_NO_COB_IMPORTER)
ADD_DEFINITIONS(-DASSIMP_BUILD_NO_CSM_IMPORTER)
ADD_DEFINITIONS(-DASSIMP_BUILD_NO_DXF_IMPORTER)
ADD_DEFINITIONS(-DASSIMP_BUILD_NO_HMP_IMPORTER)
ADD_DEFINITIONS(-DASSIMP_BUILD_NO_IFC_IMPORTER)
ADD_DEFINITIONS(-DASSIMP_BUILD_NO_IRR_IMPORTER)
ADD_DEFINITIONS(-DASSIMP_BUILD_NO_LWO_IMPORTER)
ADD_DEFINITIONS(-DASSIMP_BUILD_NO_LWS_IMPORTER)
ADD_DEFINITIONS(-DASSIMP_BUILD_NO_MD2_IMPORTER)
ADD_DEFINITIONS(-DASSIMP_BUILD_NO_MD3_IMPORTER)
ADD_DEFINITIONS(-DASSIMP_BUILD_NO_MDC_IMPORTER)
ADD_DEFINITIONS(-DASSIMP_BUILD_NO_MDL_IMPORTER)
ADD_DEFINITIONS(-DASSIMP_BUILD_NO_NDO_IMPORTER)
ADD_DEFINITIONS(-DASSIMP_BUILD_NO_NFF_IMPORTER)
ADD_DEFINITIONS(-DASSIMP_BUILD_NO_OFF_IMPORTER)
ADD_DEFINITIONS(-DASSIMP_BUILD_NO_PLY_IMPORTER)
ADD_DEFINITIONS(-DASSIMP_BUILD_NO_Q3D_IMPORTER)
ADD_DEFINITIONS(-DASSIMP_BUILD_NO_SIB_IMPORTER)
ADD_DEFINITIONS(-DASSIMP_BUILD_NO_SMD_IMPORTER)
ADD_DEFINITIONS(-DASSIMP_BUILD_NO_STL_IMPORTER)
ADD_DEFINITIONS(-DASSIMP_BUILD_NO_XGL_IMPORTER)
ADD_DEFINITIONS(-DASSIMP_BUILD_NO_AC3D_IMPORTER)
ADD_DEFINITIONS(-DASSIMP_BUILD_NO_D3MF_IMPORTER)
ADD_DEFINITIONS(-DASSIMP_BUILD_NO_MS3D_IMPORTER)
ADD_DEFINITIONS(-DASSIMP_BUILD_NO_glTF_IMPORTER)
ADD_DEFINITIONS(-DASSIMP_BUILD_NO_XFile_IMPORTER)
ADD_DEFINITIONS(-DASSIMP_BUILD_NO_Unreal_IMPORTER)
ADD_DEFINITIONS(-DASSIMP_BUILD_NO_Blender_IMPORTER)
ADD_DEFINITIONS(-DASSIMP_BUILD_NO_IRRMesh_IMPORTER)
ADD_DEFINITIONS(-DASSIMP_BUILD_NO_ObjFile_IMPORTER)
ADD_DEFINITIONS(-DASSIMP_BUILD_NO_Terragen_IMPORTER)
ADD_DEFINITIONS(-DASSIMP_BUILD_NO_Q3BSPFile_IMPORTER)
ADD_SUBDIRECTORY("${CMAKE_SOURCE_DIR}/third_party/assimp")

SET(CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS} -Wall -Werror -pedantic -ggdb -std=c++17 -stdlib=libc++ -fno-rtti")
SET(CMAKE_EXE_LINKER_FLAGS "${CMAKE_EXE_LINKER_FLAGS} -lc++experimental")

# put all artifacts in same directory
SET(CMAKE_ARCHIVE_OUTPUT_DIRECTORY ${CMAKE_CURRENT_BINARY_DIR})
SET(CMAKE_LIBRARY_OUTPUT_DIRECTORY ${CMAKE_CURRENT_BINARY_DIR})
SET(CMAKE_RUNTIME_OUTPUT_DIRECTORY ${CMAKE_CURRENT_BINARY_DIR})

# set platform variable
if(NOT PLATFORM)
    IF(${CMAKE_SYSTEM_NAME} MATCHES "Darwin")
        SET(PLATFORM "OSX")
        ADD_DEFINITIONS(-DPLATFORM_OSX)
    ELSE()
        MESSAGE(FATAL_ERROR "Unsupported platform")
    ENDIF()
ENDIF()

ADD_SUBDIRECTORY("${CMAKE_SOURCE_DIR}/src/engine")
ADD_SUBDIRECTORY("${CMAKE_SOURCE_DIR}/src/game")

